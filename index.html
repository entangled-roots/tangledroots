<!DOCTYPE HTML>
<html>
<head>
    <title>Rooted</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MVWJ3CK38C"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-MVWJ3CK38C');
    </script>

    <link rel="stylesheet" href="assets/css/main.css" />
    <link rel="stylesheet" href="search.css" />

    <!-- Leaflet Dependencies -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Leaflet Control Geocoder -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <style>
        #map {
            height: 80vh;
            width: 114%;
            position: relative;
            left: -7%;
        }
    </style>
</head>
<body class="is-preload">

    <!-- Navbar -->
    <div class="navbar">
        <a href="#intro">Roots Map</a>
        <a href="#add">Add Community</a>
        <a href="#kinship">Kinship Project</a>
    </div>

    <!-- Header -->
    <section id="header" class="dark">
        <video autoplay muted loop playsinline id="background-video">
            <source src="images/IMG_0401.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
        <div class="header-content">
            <header id="header-description">
                <h1>Rooted</h1>
                <p>Discover communities dedicated to exploring the natural world,<br>
                    from community gardens, conservation projects, to wild food initiatives and herbalismm</p>
            </header>
            <footer id="'footer-content">
                <a href="#map" class="button scrolly">Community Map</a>
            </footer> 
        </div>
    </section>

    <!-- Community Map Section -->
    <section id="intro" class="main">
        <header>
            <div class="container">
                <h2 style="font-weight: bold;">Community Map</h2>
                <p>Rooted are creating a map of communities dedicated to foraging, herbalism, permaculture, community gardening, and more—where nature’s wisdom meets grassroots connection. 
                The aim is to help people easily find communities whether moving to a new city, knowing what’s going on in your current area, or visiting new places.</p>
            </div>
            <div class="container" style="text-align: center;">
                <p>Look for the following icons on the map to find communities:</p>
                <div style="display: flex; justify-content: center; gap: 40px; align-items: center;">
                    <div style="text-align: center;">
                        <img src="images/foraging.png" alt="Foraging Icon" style="width: 40px; height: 40px;" />
                        <p>Foraging</p>
                    </div>
                    <div style="text-align: center;">
                        <img src="images/growing.png" alt="Growing Icon" style="width: 40px;" />
                        <p>Growing</p>
                    </div>
                    <div style="text-align: center;">
                        <img src="images/herb.png" alt="Herbalism Icon" style="width: 40px; height: 40px;" />
                        <p>Herbalism</p>
                    </div>
                    <div style="text-align: center;">
                        <img src="images/magnifyingplant.png" alt="General Icon" style="width: 40px;" />
                        <p>General</p>
                    </div>
                </div>
            </div>
        </header>
        <div class="content dark style1 featured">
            <div class="container">
                <div class="row">
                    <section style="width: 100%; background-color: #f4fff300">
                        <p style="text-align: center;">Click on the icons on the map for details, or find the list version below the map.</p>
                        <div id="map"></div>
                        <div id="marker-info-container" style="max-height: 400px; overflow-y: auto; color: black; padding: 20px; border: 1px solid #ccc; margin: 20px auto; background-color: #ffffffa8; max-width: 100%; text-align: center; box-sizing: border-box;"></div>
                        <style>
                            #marker-info-container::-webkit-scrollbar {
                                width: 22px;
                            }
                            #marker-info-container::-webkit-scrollbar-track {
                                background: #f1f1f1;
                            }
                            #marker-info-container::-webkit-scrollbar-thumb {
                                background: #358cef;
                                border-radius: 10px;
                            }
                            #marker-info-container::-webkit-scrollbar-thumb:hover {
                                background: #555;
                            }
                        </style>
                    </section>
                </div>
                <div class="col-12">
                    <footer>
                        <a href="#add" class="button scrolly">Add a community</a>
                    </footer>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Community Section -->
    <section id="add" class="main">
        <header>
            <div class="container">
                <h2 style="font-weight: bold;">Add a community to Rooted Community Map</h2>
                <p>We are adding to Rooted Community Map over time as new communities come under our radar. It is evolving! We also welcome you to help us grow the hub by adding communities you are part of to the map directly.</p>
            </div>
        </header>
    </section>

    <!-- Community Form -->
    <section id="community-form" class="main">
        <div class="content style2 featured"> 
            <div class="container medium">
                <form id="community-form-element">
                    <div class="row gtr-50">
                        <div class="col-6 col-12-mobile">
                            <input type="text" id="community-name" placeholder="Community Name" name="community Name" required>
                        </div>
                        <div class="col-6 col-12-mobile">
                            <input type="text" id="street-name" placeholder="Street Name" name="street Name" required>
                        </div>
                        <div class="col-6 col-12-mobile">
                            <input type="text" id="city" placeholder="City" name="city">
                        </div>
                        <div class="col-6 col-12-mobile">
                            <input type="text" id="postcode" placeholder="Postcode" name="postcode" required>
                        </div>
                        <div class="col-12">
                            <textarea id="description" placeholder="Description" name="description" rows="4" required></textarea>
                        </div>
                        <div class="col-6 col-12-mobile">
                            <input type="email" id="email" placeholder="Email Address (Optional)" name="email">
                        </div>
                        <div class="col-6 col-12-mobile">
                            <input type="url" id="website" placeholder="Website (optional)" name="website">
                        </div>
                        <div class="col-12">
                            <select id="category" name="category" required>
                                <option value="" disabled selected>Select a category</option>
                                <option value="Growing">Growing</option>
                                <option value="Foraging">Foraging</option>
                                <option value="Herbalism">Herbs</option>
                                <option value="General">General</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <ul class="actions special">
                                <li><input type="submit" class="button" value="Submit"></li>
                            </ul>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Kinship Section -->
    <section id="kinship" class="main">
        <header>
            <div class="container">
                <h2 style="font-weight: bold;">The Kinship Project</h2>
                <p>Over time Rooted will be creating videos and blogs of different communities across UK. If you would like to be involved in this project, we'd love to hear from you.</p>
            </div>
        </header>
        <div class="content style4 featured">
            <div class="container medium">
                <form method="post" action="https://formspree.io/f/mkggpojy">
                    <div class="row gtr-50">
                        <div class="col-6 col-12-mobile"><input type="text" placeholder="Name" /></div>
                        <div class="col-6 col-12-mobile"><input type="text" placeholder="Email" /></div>
                        <div class="col-12"><textarea name="message" placeholder="Message"></textarea></div>
                        <div class="col-12">
                            <ul class="actions special">
                                <li><input type="submit" class="button" value="Send Message" /></li>
                            </ul>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <section id="footer">
        <ul class="icons">
            <li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
            <li><a href="#" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
        </ul>
        <div class="copyright">
            <ul class="menu">
                <li>&copy; Rooted. All rights reserved.</li>
            </ul>
        </div>
    </section>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="script.js"></script>

    <!-- Community Form Submission Script -->
    <script>
        document.getElementById('community-form-element').addEventListener('submit', async function(e) {
            e.preventDefault();

            const formData = {
                name: document.getElementById('community-name').value.trim(),
                street: document.getElementById('street-name').value.trim(),
                city: document.getElementById('city').value.trim(),
                postcode: document.getElementById('postcode').value.trim(),
                description: document.getElementById('description').value.trim(),
                email: document.getElementById('email').value.trim(),
                website: document.getElementById('website').value.trim(),
                category: document.getElementById('category').value
            };

            try {
                const response = await fetch('https://rooted-api.onrender.com/community', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert("Thank you! Your community has been submitted and will appear on the map soon.");
                    document.getElementById('community-form-element').reset();
                } else {
                    const error = await response.json();
                    console.error("Error:", error);
                    alert("Oops! Something went wrong. Please try again or contact us directly.");
                }
            } catch (error) {
                console.error("Error:", error);
                alert("Network error. Please try again later.");
            }
        });
    </script>
</body>
</html>